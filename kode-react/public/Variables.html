<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Variables</title>
    <meta charset="UTF-8">
    <script src="http://code.jquery.com/jquery.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.11.8/semantic.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <script src="Blockly/popup.js"></script>
    <script src="Blockly/blockly_compressed.js"></script>
    <script src="Blockly/blocks_compressed.js"></script>
    <script src="Blockly/en.js"></script>
    <script src="Blockly/javascript_compressed.js"></script>
    <script src="Blockly/storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js"></script>
    <script src="Blockly/tooltip.js"></script>
    <link rel="stylesheet" type="text/css" href="BlocklyCSS.css">
</head>
<body>

<!-- nav -->
<nav class="nav">
    <div style="display:table-cell; vertical-align:middle; text-align:center">
        <a href="/" class="ui medium image">
            <img src="Blockly/logo.png" width= "160px" height= "100px" >
        </a>
    </div>
</nav>

<!-- instructions -->
<div id= "alert" class="ui pointing below yellow basic label" role="alert" style="width: 700px; margin-left: 600px;">
    <p style="color: black"><img src="https://media.giphy.com/media/3ohhwBfx3ik9jIVTOM/giphy.gif"  style="width: 30px; height: 30px;" >Create a variable by clicking on the Variable category.</p>
    <p style="color: black"><img src="https://media.giphy.com/media/3ohhwBfx3ik9jIVTOM/giphy.gif"  style="width: 30px; height: 30px;" >Drag set Variable block from the Variable category.</p>
    <p style="color: black"><img src="https://media.giphy.com/media/3ohhwBfx3ik9jIVTOM/giphy.gif"  style="width: 30px; height: 30px;" >Drag the empty text box from the Text category and place it with the set Name.</p>
    <p style="color: black"><img src="https://media.giphy.com/media/3ohhwBfx3ik9jIVTOM/giphy.gif"  style="width: 30px; height: 30px;" >Give the cartoon a name of your choice.</p>
    <p style="color: black"><img src="https://media.giphy.com/media/3ohhwBfx3ik9jIVTOM/giphy.gif"  style="width: 30px; height: 30px;" >Drag print block from text category and attach your variable name to it.</p>
</div>

<div id= "nextalert" class="ui pointing below red basic label" role="alert">
    You haven't created a variable yet!
</div>

<div id="dropElem">
    <div id="dropContent">
        <div id="dropClose">X</div>
        <div> <img src="Blockly/logo.png" width= "160px" height= "100px" style="margin-left: 200px">  </div>
        <p style="font-family: Verdana, sans-serif; text-align: center">Hi There! You have a nice name.</p>
        <div>
            <p style="font-family: Verdana, sans-serif; text-align: center">Do you know I don't have a name? Can you give me one, please?</p>
            <p style="font-family: Verdana, sans-serif; text-align: center">You can give me a name by creating a variable.</p>
            <p style="font-family: Verdana, sans-serif;text-align: center ">What's a variable though?</p>
            <p style="font-family: Verdana, sans-serif; text-align: center">Variables are name that hold values'</p>
            <p style="font-family: Verdana, sans-serif; text-align: center">To give me a name, you can create a variable Name and then set it to whatever you want to call me.</p>
            <img src="https://media.giphy.com/media/3oz8xyMwU7YPmX2rVC/giphy.gif"  style="margin-left: 60px; margin-bottom: 30px" >

            <p> PS. If you are stuck click on Hint!</p>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col-sm">
            <div class="ui vertical buttons">
            <!-- Buttons -->
            <div class="runbutton">
                <button type="button" class="ui inverted yellow button" data-toggle="tooltip" data-placement="auto"
                        title="Create a variable and give the little character a name!" >Hint
                    <i class="fa fa-question"></i></button>
            </div>

            <div class="runbutton">
                <button type="button" class="ui inverted yellow button"
                        onclick="runCode()">
                    Run <i class="fa fa-play-circle"></i></i>
                </button>
            </div>

            <div class="runbutton">
                <button type="button" class="ui inverted yellow button" onclick="next()">
                    Next <i class="fa fa-forward"></i></button>
            </div>

            <div class="runbutton">
                <button type="button" class="ui inverted yellow button" data-toggle="tooltip" data-placement="auto"
                        title="Click to save your work" onclick="saveWorkspace()">Save
                    <i class="fa fa-save 2x"></i></button>
            </div>

            <div class="runbutton">
                <button type="button" class="ui inverted yellow button" onclick="loadWorkspace()" data-toggle="tooltip" data-placement="auto"
                        title="Click on Restore, if you saved your blocks before">Restore
                    <i class="fa fa-download"></i></button>
            </div>

                <div class="runbutton">
                    <a href="/dashboard">
                        <button class="ui inverted yellow button" href="/dashboard" data-toggle="tooltip"
                                data-placement="auto"
                                title="Make sure to save your work before leaving!">Back to dashboard
                            <i class="fa fa-backward"></i></button>
                    </a>
                </div>
        </div>
    </div>
        <div id="wrapper">
            <div id="blocklyDiv" style="height: 300px; width: 600px;"></div>
            <br>
        </div>


    </div>
</div>




<xml id="toolbox" style="display: none;">
    <category name="Variables" colour="#A65C81" custom="VARIABLE"></category>
    <sep></sep>
    <category name="Text" colour="#5CA68D">
        <block type="text">
            <field name="TEXT"></field>
        </block>
        <block type="text_print">
            <value name="TEXT">
                <shadow type="text">
                    <field name="TEXT">abc</field>
                </shadow>
            </value>
        </block>
    </category>
</xml>

</body>

<script>

    let demoWorkspace = Blockly.inject('blocklyDiv',
        {toolbox: document.getElementById('toolbox')});

    function runCode() {
        window.LoopTrap = 1000;
        Blockly.JavaScript.INFINITE_LOOP_TRAP =
            'if (--window.LoopTrap == 0) throw "Infinite loop.";\n';
        var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
        Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
        console.log(code);
        if (code !== "") {
            bootbox.alert({
                message: "<p> Let's see the lines of code you have written! </p>" +
                "<p> If you are happy with it, then press next. </p>" +
                "<p> Otherwise you can play around with it. In this code you can see what is the name you have given to the cartoon. </p>" +
                "<p>" + code + "</p>" + " <img src=\"https://media.giphy.com/media/3oz8xyMwU7YPmX2rVC/giphy.gif\"  style=\"margin-bottom: 30px\" >" +
                "<p> Thank for giving me a name! </p>"
            });
        }else {
            $('#nextalert').show();
            $('#alert').hide();
        }
    }

    function next() {
        var code = Blockly.JavaScript.workspaceToCode(demoWorkspace);
        if(code === "") {
            $('#nextalert').show();
            $('#alert').hide();
        }else{
            window.location.href = "/blockly/13";
        }

    }

    function saveWorkspace() {
        var xmlDom = Blockly.Xml.workspaceToDom(Blockly.mainWorkspace);
        var xmlText = Blockly.Xml.domToPrettyText(xmlDom);
        localStorage.setItem("blockly.xml", xmlText);
    }

    function loadWorkspace() {
        var xmlText = localStorage.getItem("blockly.xml");
        if (xmlText) {
            Blockly.mainWorkspace.clear();
            xmlDom = Blockly.Xml.textToDom(xmlText);
            Blockly.Xml.domToWorkspace(Blockly.mainWorkspace, xmlDom);
        }
    }
</script>
</html>